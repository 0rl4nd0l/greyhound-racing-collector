Profile for build_leakage_safe_features
Timestamp: 2025-08-04T14:27:49.859592
Total Time: 1476.302s
CPU Time: 1341.244s
I/O Time: 0.0ms
Memory Peak: 104.12MB
Function Calls: 317515315
Bottlenecks: <20>(986.000s), /Users/orlandolee/greyhound_racing_collector/ml_system_v4.py:273(build_leakage_safe_features)(1476.071s), /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:343(build_features_for_race)(1436.828s), /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:73(load_dog_historical_data)(858.905s), /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:124(create_historical_features)(506.183s)

==================================================
Detailed cProfile Output:
         317515315 function calls (313278389 primitive calls) in 1476.071 seconds

   Ordered by: cumulative time
   List reduced from 986 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.975    0.975 1476.071 1476.071 /Users/orlandolee/greyhound_racing_collector/ml_system_v4.py:273(build_leakage_safe_features)
     1964    5.600    0.003 1436.828    0.732 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:343(build_features_for_race)
    11549    8.856    0.001  858.905    0.074 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:73(load_dog_historical_data)
    11549   24.253    0.002  506.183    0.044 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:124(create_historical_features)
    11549    0.483    0.000  424.676    0.037 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:436(read_sql_query)
    11549    0.354    0.000  424.046    0.037 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:2717(read_query)
    11549    1.180    0.000  394.026    0.034 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:196(_wrap_result)
    11549    0.193    0.000  309.258    0.027 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:10177(apply)
    11549    0.361    0.000  308.237    0.027 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/apply.py:864(apply)
    11549    0.210    0.000  307.676    0.027 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/apply.py:1061(apply_standard)
    11549    1.769    0.000  278.165    0.024 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/apply.py:1070(apply_series_generator)
    11549    3.288    0.000  277.592    0.024 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:162(_convert_arrays_to_dataframe)
    77433    1.197    0.000  261.363    0.003 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:55(get_race_timestamp)
    75469    0.208    0.000  254.792    0.003 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:104(<lambda>)
    77502    7.329    0.000  253.832    0.003 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/tools/datetimes.py:678(to_datetime)
    77502    5.822    0.000  235.106    0.003 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/tools/datetimes.py:316(_convert_listlike_datetimes)
    13126    1.072    0.000  225.383    0.017 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:694(__init__)
  1289240   68.356    0.000  217.512    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/construction.py:517(sanitize_array)
    11549    8.760    0.001  206.510    0.018 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:423(dict_to_mgr)
287670/264572    1.132    0.000  204.513    0.001 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/ops/common.py:62(new_method)


