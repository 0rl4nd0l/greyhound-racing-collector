Profile for build_leakage_safe_features
Timestamp: 2025-08-04T02:30:59.592027
Total Time: 1672.209s
CPU Time: 1645.695s
I/O Time: 0.0ms
Memory Peak: 154.69MB
Function Calls: 522885065
Bottlenecks: <20>(868.000s), /Users/orlandolee/greyhound_racing_collector/ml_system_v4.py:139(build_leakage_safe_features)(1672.092s), /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:268(build_features_for_race)(1643.862s), /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:73(load_dog_historical_data)(1088.024s), /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:436(read_sql_query)(529.358s)

==================================================
Detailed cProfile Output:
         522885065 function calls (515798994 primitive calls) in 1672.092 seconds

   Ordered by: cumulative time
   List reduced from 868 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.914    0.914 1672.092 1672.092 /Users/orlandolee/greyhound_racing_collector/ml_system_v4.py:139(build_leakage_safe_features)
     2564    6.622    0.003 1643.862    0.641 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:268(build_features_for_race)
    20400   10.689    0.001 1088.024    0.053 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:73(load_dog_historical_data)
    20400    0.669    0.000  529.358    0.026 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:436(read_sql_query)
    20400    0.480    0.000  528.483    0.026 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:2717(read_query)
    20400   20.748    0.001  497.147    0.024 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:124(create_historical_features)
    20400    1.482    0.000  491.331    0.024 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:196(_wrap_result)
    20400    0.260    0.000  409.221    0.020 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:10177(apply)
    20400    0.498    0.000  407.825    0.020 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/apply.py:864(apply)
    20400    0.278    0.000  407.066    0.020 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/apply.py:1061(apply_standard)
    20400    2.379    0.000  371.136    0.018 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/apply.py:1070(apply_series_generator)
    20400    4.290    0.000  347.162    0.017 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:162(_convert_arrays_to_dataframe)
   146674    1.516    0.000  346.976    0.002 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:55(get_race_timestamp)
   144110    0.288    0.000  340.820    0.002 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:104(<lambda>)
   146711    9.649    0.000  337.213    0.002 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/tools/datetimes.py:678(to_datetime)
   146711    7.867    0.000  313.569    0.002 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/tools/datetimes.py:316(_convert_listlike_datetimes)
    22964    1.450    0.000  280.835    0.012 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:694(__init__)
    20400   11.395    0.001  259.380    0.013 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:423(dict_to_mgr)
  2074647   81.323    0.000  256.765    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/construction.py:517(sanitize_array)
    22964    1.576    0.000  236.038    0.010 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:96(arrays_to_mgr)


