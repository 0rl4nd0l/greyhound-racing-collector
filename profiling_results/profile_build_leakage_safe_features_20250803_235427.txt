Profile for build_leakage_safe_features
Timestamp: 2025-08-03T23:54:27.759372
Total Time: 0.206s
CPU Time: 0.204s
I/O Time: 0.0ms
Memory Peak: 1.43MB
Function Calls: 73198
Bottlenecks: <20>(606.000s), /Users/orlandolee/greyhound_racing_collector/ml_system_v4.py:139(build_leakage_safe_features)(0.205s), /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:268(build_features_for_race)(0.199s), /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:73(load_dog_historical_data)(0.162s), /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:436(read_sql_query)(0.151s)

==================================================
Detailed cProfile Output:
         73198 function calls (71806 primitive calls) in 0.206 seconds

   Ordered by: cumulative time
   List reduced from 606 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.205    0.205 /Users/orlandolee/greyhound_racing_collector/ml_system_v4.py:139(build_leakage_safe_features)
        1    0.002    0.002    0.199    0.199 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:268(build_features_for_race)
        5    0.000    0.000    0.162    0.032 /Users/orlandolee/greyhound_racing_collector/temporal_feature_builder.py:73(load_dog_historical_data)
        5    0.000    0.000    0.151    0.030 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:436(read_sql_query)
        5    0.000    0.000    0.151    0.030 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:2717(read_query)
        5    0.000    0.000    0.143    0.029 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:196(_wrap_result)
       11    0.001    0.000    0.124    0.011 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:694(__init__)
       10    0.005    0.001    0.113    0.011 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:423(dict_to_mgr)
        5    0.000    0.000    0.109    0.022 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:162(_convert_arrays_to_dataframe)
      708    0.019    0.000    0.040    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/construction.py:517(sanitize_array)
      320    0.005    0.000    0.040    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/indexing.py:2529(__setitem__)
       11    0.000    0.000    0.037    0.003 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:96(arrays_to_mgr)
        5    0.001    0.000    0.034    0.007 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/io/sql.py:141(_parse_date_columns)
      320    0.000    0.000    0.033    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/series.py:1431(_set_value)
      320    0.001    0.000    0.033    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/series.py:1424(_set_values)
      325    0.000    0.000    0.032    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:1501(items)
       11    0.004    0.000    0.031    0.003 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:596(_homogenize)
      323    0.002    0.000    0.031    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:4631(_get_item_cache)
      323    0.002    0.000    0.028    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/frame.py:3988(_ixs)
      320    0.003    0.000    0.024    0.000 /Users/orlandolee/greyhound_racing_collector/venv/lib/python3.13/site-packages/pandas/core/internals/managers.py:372(setitem)


